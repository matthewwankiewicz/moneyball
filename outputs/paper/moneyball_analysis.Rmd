---
title: "Was the basis of Moneyball Correct?"
author: "Matthew Wankiewicz"
date: "26/11/2020"
bibliography: references.bib
abstract: "The book moneyball highlighted a statisitcs revolution that was occuring in baseball in the early 2000's. In this report, I will use logistic regression to determine whether the advanced stats that stemmed from this revolution are useful for predicting a team's success. According to the model I still have to do this. The model correctly predicted that (insert) teams would make the playoffs using these metrics. "
output: pdf_document
---
**Keywords**: Moneyball, Baseball, Sabermetrics, Logistic Regression

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = F)
knitr::opts_chunk$set(warning = F)
#install.packages("tidyverse")
library(tidyverse)
#install.packages("Lahman")
library(Lahman)
#install.packages("blscrapeR")
library(blscrapeR)
```


```{r, message=F}
all_years <- read_csv("all_years.csv")
```

## Introduction

In 2003, Michael Lewis released a book called Moneyball ^[Moneyball was actually part of the reason I decided to get into statistics. Applying baseball with numbers seemed like an absolute win to me]. Moneyball is the story of the Oakland Athletics who, after losing players to the richer teams in the league, decided to focus on using the misfits of baseball to try to win a World Series. These "misfits" were players who never received support from teams because their traditional stats didn't look good but they excelled in the stats that mattered.

This data analysis was conducted using R (@citeR), and in particular the packages Tidyverse (@citeTidyverse) and Lahman (@citeLahman) and was compiled using R markdown (@citermarkdown).

## Data

```{r plot1, echo=F, fig.cap="The increase in Payroll over the Years"}
all_years %>% 
  ggplot(aes(x = yearID, y = log(payroll), color = playoffs)) +
  geom_point()
```


```{r woba, fig.cap="Relationship between wOBA and Wins"}
all_years %>% 
  ggplot(aes(W, wOBA, color = playoffs)) + 
  geom_point() 
```

```{r fip, fig.cap="Relationship between FIP and Wins"}
all_years %>% 
  ggplot(aes(W, FIP, color = playoffs)) + 
  geom_point() 
```


## Model

```{r model}
model <- glm(playoffs ~ wOBA + FIP + log(payroll) + BA
             + ERA,
             data = all_years, family = binomial())
summary(model)
coefficients <- broom::tidy(model)
coefficients %>% 
  knitr::kable(digits = 4) %>% 
  kableExtra::kable_styling()
```

Table \@ref(tab:model) shows us the coefficients from our logistic regression model. We see that teams with a higher wOBA have better chances of making the playoffs, along with team with higher payrolls. This makes sense because when teams will attempt to spend the most money to get the best players and when they score more runs they'll win more games. We can also see that the coefficient for FIP is negative, this does not mean that FIP brings down the chances of making the playoffs. The best values for FIP are the ones closer to 0 and as the value begins to increase, it shows that the pitcher is not that good. What the coefficient is telling us is that lower FIP's give higher chances of making the playoffs while higher FIP's bring down the chances of making the playoffs.

```{r cooks}
plot(model, which = 4)
```

Figure \@ref(fig:cooks) shows us the observed cook's distances for the model. Cook's distance gives us the difference between the ... . We see that these cook's distances are very low (most are under 0.01), since our distances are fairly low, we can conclude that the model is fitting the data fairly well.

```{r}
all_years_predict <- all_years
all_years_predict$estimate <- predict.glm(model, newdata = all_years,
                                          type = "response")
all_years_predict <- all_years_predict %>% 
  mutate(playoffs_predict = ifelse(estimate > 0.5, 1, 0))

sum(all_years_predict$playoffs)/nrow(all_years_predict)
sum(all_years_predict$playoffs_predict)/nrow(all_years_predict)
```



## Discussion

## Weaknesses and Next Steps

## References
